import"./request-BarWf1iR.js";/* empty css                   *//* empty css                     *//* empty css                     */import{e as W,a as X,p as Z,b as G,f as J,h as K}from"./exam-qe0bbvjk.js";import{_ as ee,b as te}from"./question-COitR8B5.js";import{$ as q,f as E,r as b,c as m,a as s,t as ae,u as w,b as t,w as i,d as z,O as x,E as oe,Z as se,Q as le,U as ie,a0 as ne,o as p,k as c,W as de,X as r,p as ue,e as ce,Y as me,P as pe,R as re,V as _e}from"./index-Br-KH4mf.js";import{_ as fe}from"./_plugin-vue_export-helper-DlAUqK2U.js";const I=v=>(ue("data-v-f20b54bb"),v=v(),ce(),v),xe={class:"add-exam-component-box"},ve={class:"add-exam-component"},ye={class:"exam-base-info-box"},be={class:"exam-base-title"},ge={class:"base-title"},he={class:"exam-base-info"},Ee={class:"group-box"},Ie={class:"group-item"},ke=I(()=>s("div",{class:"item-label required"},"竞赛名称",-1)),Se={class:"group-box"},Ce={class:"group-item"},De=I(()=>s("div",{class:"item-label required"},"竞赛周期",-1)),Ve={class:"group-box"},qe={class:"group-item"},we={class:"exam-select-question-box"},ze={key:0,style:{color:"#3EC8FF"}},Fe={key:1,style:{color:"#FE7909"}},Qe={key:2,style:{color:"#FD4C40"}},Ne={class:"exam-list-box"},Ue=I(()=>s("div",{class:"exam-list-title required"},"选择竞赛题目",-1)),Te={key:0,style:{color:"#3EC8FF"}},Be={key:1,style:{color:"#FE7909"}},Le={key:2,style:{color:"#FD4C40"}},Re={class:"exam-question-list-button"},Ye={class:"submit-box absolute"},Pe={__name:"UpdateExam",setup(v){const F=q().query.type,l=E({examId:"",title:"",examDate:""}),n=E({pageNum:1,pageSize:10,difficulty:"",title:""});function k(){z.go(-1)}async function Q(){const a=new FormData;for(let e in l)e==="examDate"?(a.append("startTime",l.examDate[0]),a.append("endTime",l.examDate[1])):e!=="startTime"&&e!=="endTime"&&a.append(e,l[e]);if(l.examId)await W(a);else{const e=await X(a);l.examId=e.data}x.success("基本信息保存成功")}const S=b([]),C=b(0);async function _(){const a=await te(n);console.log(a),S.value=a.rows,C.value=a.total}const y=b(!1);function N(){l.examId===null||l.examId===""?x.error("请先保存竞赛基本信息"):(_(),y.value=!0)}function U(){n.pageNum=1,_()}function T(){_()}function B(){n.pageNum=1,_()}function L(){n.pageNum=1,n.pageSize=10,n.title="",n.difficulty="",_()}async function R(){await Z(l.examId),z.push("/oj/layout/exam")}const f=b([]);function Y(a){f.value=[],a.forEach(e=>{f.value.push(e.questionId)})}async function P(){if(f.value&&f.value.length<1)return x.error("请先选择要提交的题目"),!1;const a=E({examId:l.examId,questionIdSet:f.value});console.log(a),await J(a),g(l.examId),y.value=!1,x.success("竞赛题目添加成功")}async function $(){const a=q().query.examId;a&&(l.examId=a,g(a))}$();async function j(a,e){await K(a,e),g(a),x.success("竞赛题目删除成功")}async function g(a){const e=await G(a);l.examQuestionList=[],Object.assign(l,e.data),l.examDate=[e.data.startTime,e.data.endTime]}return(a,e)=>{const D=oe,M=se,d=le,u=me,V=ie,h=pe,H=re,O=_e,A=ne;return p(),m("div",xe,[s("div",ve,[s("div",ye,[s("div",be,[s("span",ge,ae(w(F)==="edit"?"编辑竞赛":"添加竞赛"),1),s("span",{class:"go-back",onClick:k},"返回")]),s("div",he,[s("div",Ee,[s("div",Ie,[ke,s("div",null,[t(D,{modelValue:l.title,"onUpdate:modelValue":e[0]||(e[0]=o=>l.title=o),style:{width:"420px"},placeholder:"请填写竞赛名称"},null,8,["modelValue"])])])]),s("div",Se,[s("div",Ce,[De,s("div",null,[t(M,{modelValue:l.examDate,"onUpdate:modelValue":e[1]||(e[1]=o=>l.examDate=o),disabledDate:a.disabledDate,type:"datetimerange","start-placeholder":"竞赛开始时间","end-placeholder":"竞赛结束时间","value-format":"YYYY-MM-DD HH:mm:ss"},null,8,["modelValue","disabledDate"])])])]),s("div",Ve,[s("div",qe,[t(d,{class:"exam-base-info-button",type:"primary",plain:"",onClick:Q},{default:i(()=>[c("保存")]),_:1})])])])]),s("div",we,[t(d,{class:"exam-add-question",icon:w(de),type:"text",onClick:e[2]||(e[2]=o=>N())},{default:i(()=>[c(" 添加题目 ")]),_:1},8,["icon"]),t(V,{height:"136px",data:l.examQuestionList,class:"question-select-list"},{default:i(()=>[t(u,{prop:"questionId",width:"180px",label:"题目id"}),t(u,{prop:"title","show-overflow-tooltip":!0,label:"题目标题"}),t(u,{prop:"difficulty",width:"80px",label:"题目难度"},{default:i(({row:o})=>[o.difficulty===1?(p(),m("div",ze,"简单")):r("",!0),o.difficulty===2?(p(),m("div",Fe,"中等")):r("",!0),o.difficulty===3?(p(),m("div",Qe,"困难")):r("",!0)]),_:1}),t(u,{label:"操作",width:"80px"},{default:i(({row:o})=>[t(d,{circle:"",type:"text",onClick:$e=>j(l.examId,o.questionId)},{default:i(()=>[c(" 删除 ")]),_:2},1032,["onClick"])]),_:1})]),_:1},8,["data"])]),s("div",null,[t(A,{modelValue:y.value,"onUpdate:modelValue":e[7]||(e[7]=o=>y.value=o)},{default:i(()=>[s("div",Ne,[Ue,t(H,{inline:"true"},{default:i(()=>[t(h,{label:"题目难度"},{default:i(()=>[t(ee,{modelValue:n.difficulty,"onUpdate:modelValue":e[3]||(e[3]=o=>n.difficulty=o),style:{width:"120px"}},null,8,["modelValue"])]),_:1}),t(h,{label:"题目名称"},{default:i(()=>[t(D,{modelValue:n.title,"onUpdate:modelValue":e[4]||(e[4]=o=>n.title=o),placeholder:"请您输入要搜索的题目标题"},null,8,["modelValue"])]),_:1}),t(h,null,{default:i(()=>[t(d,{onClick:B,plain:""},{default:i(()=>[c("搜索")]),_:1}),t(d,{onClick:L,plain:"",type:"info"},{default:i(()=>[c("重置")]),_:1})]),_:1})]),_:1}),t(V,{data:S.value,onSelect:Y},{default:i(()=>[t(u,{type:"selection"}),t(u,{prop:"questionId",label:"题目id"}),t(u,{prop:"title",label:"题目标题"}),t(u,{prop:"difficulty",label:"题目难度"},{default:i(({row:o})=>[o.difficulty===1?(p(),m("div",Te,"简单")):r("",!0),o.difficulty===2?(p(),m("div",Be,"中等")):r("",!0),o.difficulty===3?(p(),m("div",Le,"困难")):r("",!0)]),_:1})]),_:1},8,["data"]),s("div",Re,[t(O,{background:"",size:"small",layout:"total, sizes, prev, pager, next, jumper",total:C.value,"current-page":n.pageNum,"onUpdate:currentPage":e[5]||(e[5]=o=>n.pageNum=o),"page-size":n.pageSize,"onUpdate:pageSize":e[6]||(e[6]=o=>n.pageSize=o),"page-sizes":[1,5,10,15,20],onSizeChange:U,onCurrentChange:T},null,8,["total","current-page","page-size"]),t(d,{class:"question-select-submit",type:"primary",plain:"",onClick:P},{default:i(()=>[c("提交")]),_:1})])])]),_:1},8,["modelValue"])]),s("div",Ye,[t(d,{type:"info",plain:"",onClick:k},{default:i(()=>[c("取消")]),_:1}),t(d,{type:"primary",plain:"",onClick:R},{default:i(()=>[c("发布竞赛")]),_:1})])])])}}},Ge=fe(Pe,[["__scopeId","data-v-f20b54bb"]]);export{Ge as default};
